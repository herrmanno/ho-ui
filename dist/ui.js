var ho;
(function (ho) {
    var ui;
    (function (ui) {
        function run(options) {
            if (options === void 0) { options = new Options(); }
            options = new Options(options);
            var p = options.process()
                .then(ho.components.run)
                .then(ho.flux.run);
            return p;
        }
        ui.run = run;
        var components = [
            "FluxComponent",
            "View",
        ];
        var attributes = [
            "Bind",
            "BindBi",
        ];
        var stores = [];
        var Options = (function () {
            function Options(opt) {
                if (opt === void 0) { opt = {}; }
                this.root = "App";
                this.router = ho.flux.Router;
                this.map = true;
                this.mapDefault = "bower_components/ho-ui/dist/";
                this.dir = true;
                this.min = false;
                for (var key in opt) {
                    this[key] = opt[key];
                }
            }
            Options.prototype.process = function () {
                return ho.promise.Promise.create(this.processDir())
                    .then(this.processMin.bind(this))
                    .then(this.processMap.bind(this))
                    .then(this.processRouter.bind(this))
                    .then(this.processRoot.bind(this));
            };
            Options.prototype.processRoot = function () {
                var _this = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof _this.root === 'string') {
                        ho.components.registry.instance.loadComponent(_this.root)
                            .then(resolve)
                            .catch(reject);
                    }
                    else {
                        ho.components.registry.instance.register(_this.root);
                        resolve(null);
                    }
                });
            };
            Options.prototype.processRouter = function () {
                var _this = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof _this.router === 'string') {
                        ho.flux.STORES.loadStore(_this.router, false)
                            .then(function (r) { return resolve(r); })
                            .catch(reject);
                    }
                    else {
                        resolve(new _this.router());
                    }
                })
                    .then(function (r) {
                    ho.flux.Router = r.constructor;
                    ho.flux.STORES.register(r);
                });
            };
            Options.prototype.processMap = function () {
                var _this = this;
                if (typeof this.map === 'boolean') {
                    if (!this.map)
                        return;
                    else
                        this.map = this.mapDefault;
                }
                components.forEach(function (c) {
                    //ho.components.registry.mapping[c] = this.map + 'components/' + c + '/' + c + '.js';
                    ho.classloader.mapping[c] = _this.map + 'components/' + c + '/' + c + '.js';
                });
                attributes.forEach(function (a) {
                    //ho.components.registry.mapping[a] = this.map + 'attributes/' + a + '/' + a + '.js';
                    ho.classloader.mapping[a] = _this.map + 'attributes/' + a + '/' + a + '.js';
                });
                stores.forEach(function (s) {
                    //ho.flux.registry.mapping[s] = this.map + 'stores/' + s + '/' + s + '.js';
                    ho.classloader.mapping[s] = _this.map + 'stores/' + s + '/' + s + '.js';
                });
            };
            Options.prototype.processDir = function () {
                ho.components.registry.useDir = this.dir;
                ho.flux.registry.useDir = this.dir;
                ho.flux.actions.useDir = this.dir;
            };
            Options.prototype.processMin = function () {
                /*
                ho.components.componentprovider.instance.useMin = this.min;
                ho.components.attributeprovider.instance.useMin = this.min;
                ho.flux.storeprovider.instance.useMin = this.min;
                */
            };
            return Options;
        })();
    })(ui = ho.ui || (ho.ui = {}));
})(ho || (ho = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVpLnRzIl0sIm5hbWVzIjpbImhvIiwiaG8udWkiLCJoby51aS5ydW4iLCJoby51aS5PcHRpb25zIiwiaG8udWkuT3B0aW9ucy5jb25zdHJ1Y3RvciIsImhvLnVpLk9wdGlvbnMucHJvY2VzcyIsImhvLnVpLk9wdGlvbnMucHJvY2Vzc1Jvb3QiLCJoby51aS5PcHRpb25zLnByb2Nlc3NSb3V0ZXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNYXAiLCJoby51aS5PcHRpb25zLnByb2Nlc3NEaXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNaW4iXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sRUFBRSxDQWdJUjtBQWhJRCxXQUFPLEVBQUU7SUFBQ0EsSUFBQUEsRUFBRUEsQ0FnSVhBO0lBaElTQSxXQUFBQSxFQUFFQSxFQUFDQSxDQUFDQTtRQUViQyxhQUFvQkEsT0FBOEJBO1lBQTlCQyx1QkFBOEJBLEdBQTlCQSxjQUFxQkEsT0FBT0EsRUFBRUE7WUFDakRBLE9BQU9BLEdBQUdBLElBQUlBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1lBRS9CQSxJQUFJQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQSxPQUFPQSxFQUFFQTtpQkFDeEJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBO2lCQUN2QkEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFFbkJBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ1ZBLENBQUNBO1FBUmVELE1BQUdBLE1BUWxCQSxDQUFBQTtRQUVEQSxJQUFJQSxVQUFVQSxHQUFHQTtZQUNoQkEsZUFBZUE7WUFDZkEsTUFBTUE7U0FDTkEsQ0FBQ0E7UUFFRkEsSUFBSUEsVUFBVUEsR0FBR0E7WUFDaEJBLE1BQU1BO1lBQ05BLFFBQVFBO1NBQ1JBLENBQUNBO1FBRUZBLElBQUlBLE1BQU1BLEdBQUdBLEVBRVpBLENBQUNBO1FBV0ZBO1lBUUNF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LEtBQUVBLEtBQUZBLEtBQUVBLFFBZ0lYQTtBQUFEQSxDQUFDQSxFQWhJTSxFQUFFLEtBQUYsRUFBRSxRQWdJUiIsImZpbGUiOiJ1aS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZSBoby51aSB7XHJcblxyXG5cdGV4cG9ydCBmdW5jdGlvbiBydW4ob3B0aW9uczpJT3B0aW9ucz1uZXcgT3B0aW9ucygpKTogaG8ucHJvbWlzZS5Qcm9taXNlPGFueSwgYW55PiB7XHJcblx0XHRvcHRpb25zID0gbmV3IE9wdGlvbnMob3B0aW9ucyk7XHJcblxyXG5cdFx0bGV0IHAgPSBvcHRpb25zLnByb2Nlc3MoKVxyXG5cdFx0LnRoZW4oaG8uY29tcG9uZW50cy5ydW4pXHJcblx0XHQudGhlbihoby5mbHV4LnJ1bik7XHJcblxyXG5cdFx0cmV0dXJuIHA7XHJcblx0fVxyXG5cclxuXHRsZXQgY29tcG9uZW50cyA9IFtcclxuXHRcdFwiRmx1eENvbXBvbmVudFwiLFxyXG5cdFx0XCJWaWV3XCIsXHJcblx0XTtcclxuXHJcblx0bGV0IGF0dHJpYnV0ZXMgPSBbXHJcblx0XHRcIkJpbmRcIixcclxuXHRcdFwiQmluZEJpXCIsXHJcblx0XTtcclxuXHJcblx0bGV0IHN0b3JlcyA9IFtcclxuXHJcblx0XTtcclxuXHJcblx0ZXhwb3J0IGludGVyZmFjZSBJT3B0aW9ucyB7XHJcblx0XHRyb290OiBzdHJpbmcgfCB0eXBlb2YgaG8uY29tcG9uZW50cy5Db21wb25lbnQ7IC8vUm9vdCBjb21wb25lbnQgdG8gcmVnaXN0ZXI7XHJcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlcjsgLy9hbHRlcm5hdGl2ZSByb3V0ZXIgY2xhc3NcclxuXHRcdG1hcDogc3RyaW5nIHwgYm9vbGVhbjsgLy8gaWYgc2V0LCBtYXAgYWxsIGhvLnVpIGNvbXBvbmVudHMgaW4gdGhlIGNvbXBvbmVudHByb3ZpZGVyIHRvIHRoZSBnaXZlbiB1cmxcclxuXHRcdGRpcjogYm9vbGVhbjsgLy8gc2V0IHVzZWRpciBpbiBoby5jb21wb25lbnRzXHJcblx0XHRtaW46IGJvb2xlYW47XHJcblx0XHRwcm9jZXNzOiAoKT0+aG8ucHJvbWlzZS5Qcm9taXNlPGFueSwgYW55PjtcclxuXHR9XHJcblxyXG5cdGNsYXNzIE9wdGlvbnMgaW1wbGVtZW50cyBJT3B0aW9ucyB7XHJcblx0XHRyb290OiBzdHJpbmcgfCB0eXBlb2YgaG8uY29tcG9uZW50cy5Db21wb25lbnQgPSBcIkFwcFwiXHJcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlciA9IGhvLmZsdXguUm91dGVyO1xyXG5cdFx0bWFwOiBzdHJpbmcgfCBib29sZWFuID0gdHJ1ZTtcclxuXHRcdG1hcERlZmF1bHQgPSBcImJvd2VyX2NvbXBvbmVudHMvaG8tdWkvZGlzdC9cIjtcclxuXHRcdGRpciA9IHRydWU7XHJcblx0XHRtaW4gPSBmYWxzZTtcclxuXHJcblx0XHRjb25zdHJ1Y3RvcihvcHQ6IElPcHRpb25zID0gPElPcHRpb25zPnt9KSB7XHJcblx0XHRcdGZvcih2YXIga2V5IGluIG9wdCkge1xyXG5cdFx0XHRcdHRoaXNba2V5XSA9IG9wdFtrZXldO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvY2VzcygpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+e1xyXG5cdFx0XHRyZXR1cm4gaG8ucHJvbWlzZS5Qcm9taXNlLmNyZWF0ZSh0aGlzLnByb2Nlc3NEaXIoKSlcclxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzTWluLmJpbmQodGhpcykpXHJcblx0XHRcdC50aGVuKHRoaXMucHJvY2Vzc01hcC5iaW5kKHRoaXMpKVxyXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NSb3V0ZXIuYmluZCh0aGlzKSlcclxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzUm9vdC5iaW5kKHRoaXMpKVxyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzUm9vdCgpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBoby5wcm9taXNlLlByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiB0aGlzLnJvb3QgPT09ICdzdHJpbmcnKSB7XHJcblx0XHRcdFx0XHRoby5jb21wb25lbnRzLnJlZ2lzdHJ5Lmluc3RhbmNlLmxvYWRDb21wb25lbnQoPHN0cmluZz50aGlzLnJvb3QpXHJcblx0XHRcdFx0XHQudGhlbihyZXNvbHZlKVxyXG5cdFx0XHRcdFx0LmNhdGNoKHJlamVjdCk7XHJcblxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRoby5jb21wb25lbnRzLnJlZ2lzdHJ5Lmluc3RhbmNlLnJlZ2lzdGVyKDx0eXBlb2YgaG8uY29tcG9uZW50cy5Db21wb25lbnQ+dGhpcy5yb290KVxyXG5cdFx0XHRcdFx0cmVzb2x2ZShudWxsKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzUm91dGVyKCk6IGhvLnByb21pc2UuUHJvbWlzZTxhbnksIGFueT4ge1xyXG5cdFx0XHRyZXR1cm4gbmV3IGhvLnByb21pc2UuUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHRoaXMucm91dGVyID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0aG8uZmx1eC5TVE9SRVMubG9hZFN0b3JlKDxzdHJpbmc+dGhpcy5yb3V0ZXIsIGZhbHNlKVxyXG5cdFx0XHRcdFx0LnRoZW4ociA9PiByZXNvbHZlKHIpKVxyXG5cdFx0XHRcdFx0LmNhdGNoKHJlamVjdCk7XHJcblxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKG5ldyAoPHR5cGVvZiBoby5mbHV4LlJvdXRlcj50aGlzLnJvdXRlcikoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0XHQudGhlbigocjogaG8uZmx1eC5Sb3V0ZXIpID0+IHtcclxuXHRcdFx0XHRoby5mbHV4LlJvdXRlciA9IDx0eXBlb2YgaG8uZmx1eC5Sb3V0ZXI+ci5jb25zdHJ1Y3RvcjtcclxuXHRcdFx0XHRoby5mbHV4LlNUT1JFUy5yZWdpc3RlcihyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzTWFwKCk6IHZvaWQge1xyXG5cdFx0XHRpZih0eXBlb2YgdGhpcy5tYXAgPT09ICdib29sZWFuJykge1xyXG5cdFx0XHRcdGlmKCF0aGlzLm1hcClcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHR0aGlzLm1hcCA9IHRoaXMubWFwRGVmYXVsdDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y29tcG9uZW50cy5mb3JFYWNoKGMgPT4ge1xyXG5cdFx0XHRcdC8vaG8uY29tcG9uZW50cy5yZWdpc3RyeS5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcclxuXHRcdFx0XHRoby5jbGFzc2xvYWRlci5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVzLmZvckVhY2goYSA9PiB7XHJcblx0XHRcdFx0Ly9oby5jb21wb25lbnRzLnJlZ2lzdHJ5Lm1hcHBpbmdbYV0gPSB0aGlzLm1hcCArICdhdHRyaWJ1dGVzLycgKyBhICsgJy8nICsgYSArICcuanMnO1xyXG5cdFx0XHRcdGhvLmNsYXNzbG9hZGVyLm1hcHBpbmdbYV0gPSB0aGlzLm1hcCArICdhdHRyaWJ1dGVzLycgKyBhICsgJy8nICsgYSArICcuanMnO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHN0b3Jlcy5mb3JFYWNoKHMgPT4ge1xyXG5cdFx0XHRcdC8vaG8uZmx1eC5yZWdpc3RyeS5tYXBwaW5nW3NdID0gdGhpcy5tYXAgKyAnc3RvcmVzLycgKyBzICsgJy8nICsgcyArICcuanMnO1xyXG5cdFx0XHRcdGhvLmNsYXNzbG9hZGVyLm1hcHBpbmdbc10gPSB0aGlzLm1hcCArICdzdG9yZXMvJyArIHMgKyAnLycgKyBzICsgJy5qcyc7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzRGlyKCk6IHZvaWQge1xyXG5cdFx0XHRoby5jb21wb25lbnRzLnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LmFjdGlvbnMudXNlRGlyID0gdGhpcy5kaXI7XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NNaW4oKTogdm9pZCB7XHJcblx0XHRcdC8qXHJcblx0XHRcdGhvLmNvbXBvbmVudHMuY29tcG9uZW50cHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmNvbXBvbmVudHMuYXR0cmlidXRlcHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmZsdXguc3RvcmVwcm92aWRlci5pbnN0YW5jZS51c2VNaW4gPSB0aGlzLm1pbjtcclxuXHRcdFx0Ki9cclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==