var ho;
(function (ho) {
    var ui;
    (function (ui) {
        function run(options) {
            if (options === void 0) { options = new Options(); }
            options = new Options(options);
            var p = options.process()
                .then(ho.components.run.bind(ho.components, undefined))
                .then(ho.flux.run.bind(ho.flux, undefined));
            return p;
        }
        ui.run = run;
        var components = [
            "FluxComponent",
            "View",
        ];
        var attributes = [
            "Bind",
            "BindBi",
            "Disable"
        ];
        var stores = [];
        var Options = (function () {
            function Options(opt) {
                if (opt === void 0) { opt = {}; }
                this.root = "App";
                this.router = ho.flux.Router;
                this.map = true;
                this.mapDefault = "bower_components/ho-ui/dist/";
                this.dir = true;
                this.min = false;
                for (var key in opt) {
                    this[key] = opt[key];
                }
            }
            Options.prototype.process = function () {
                return ho.promise.Promise.create(this.processDir())
                    .then(this.processMin.bind(this))
                    .then(this.processMap.bind(this))
                    .then(this.processRouter.bind(this))
                    .then(this.processRoot.bind(this));
            };
            Options.prototype.processRoot = function () {
                var self = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof self.root === 'string') {
                        ho.components.registry.instance.loadComponent(self.root)
                            .then(resolve)
                            .catch(reject);
                    }
                    else {
                        ho.components.registry.instance.register(self.root);
                        resolve(null);
                    }
                });
            };
            Options.prototype.processRouter = function () {
                var self = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof self.router === 'string') {
                        ho.flux.STORES.loadStore(self.router, false)
                            .then(function (r) { return resolve(r); })
                            .catch(reject);
                    }
                    else {
                        resolve(new self.router());
                    }
                })
                    .then(function (r) {
                    ho.flux.Router = r.constructor;
                    ho.flux.STORES.register(r);
                });
            };
            Options.prototype.processMap = function () {
                var _this = this;
                if (typeof this.map === 'boolean') {
                    if (!this.map)
                        return;
                    else
                        this.map = this.mapDefault;
                }
                components.forEach(function (c) {
                    //ho.components.registry.mapping[c] = this.map + 'components/' + c + '/' + c + '.js';
                    ho.classloader.mapping[c] = _this.map + 'components/' + c + '/' + c + '.js';
                });
                attributes.forEach(function (a) {
                    //ho.components.registry.mapping[a] = this.map + 'attributes/' + a + '/' + a + '.js';
                    ho.classloader.mapping[a] = _this.map + 'attributes/' + a + '/' + a + '.js';
                });
                stores.forEach(function (s) {
                    //ho.flux.registry.mapping[s] = this.map + 'stores/' + s + '/' + s + '.js';
                    ho.classloader.mapping[s] = _this.map + 'stores/' + s + '/' + s + '.js';
                });
            };
            Options.prototype.processDir = function () {
                ho.components.registry.useDir = this.dir;
                ho.flux.registry.useDir = this.dir;
                ho.flux.actions.useDir = this.dir;
            };
            Options.prototype.processMin = function () {
                /*
                ho.components.componentprovider.instance.useMin = this.min;
                ho.components.attributeprovider.instance.useMin = this.min;
                ho.flux.storeprovider.instance.useMin = this.min;
                */
            };
            return Options;
        })();
    })(ui = ho.ui || (ho.ui = {}));
})(ho || (ho = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvL3VpL3VpLnRzIl0sIm5hbWVzIjpbImhvIiwiaG8udWkiLCJoby51aS5ydW4iLCJoby51aS5PcHRpb25zIiwiaG8udWkuT3B0aW9ucy5jb25zdHJ1Y3RvciIsImhvLnVpLk9wdGlvbnMucHJvY2VzcyIsImhvLnVpLk9wdGlvbnMucHJvY2Vzc1Jvb3QiLCJoby51aS5PcHRpb25zLnByb2Nlc3NSb3V0ZXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNYXAiLCJoby51aS5PcHRpb25zLnByb2Nlc3NEaXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNaW4iXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sRUFBRSxDQW1JUjtBQW5JRCxXQUFPLEVBQUU7SUFBQ0EsSUFBQUEsRUFBRUEsQ0FtSVhBO0lBbklTQSxXQUFBQSxFQUFFQSxFQUFDQSxDQUFDQTtRQUViQyxhQUFvQkEsT0FBOEJBO1lBQTlCQyx1QkFBOEJBLEdBQTlCQSxjQUFxQkEsT0FBT0EsRUFBRUE7WUFDakRBLE9BQU9BLEdBQUdBLElBQUlBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1lBRS9CQSxJQUFJQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQSxPQUFPQSxFQUFFQTtpQkFDeEJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLEVBQUVBLFNBQVNBLENBQUNBLENBQUNBO2lCQUN0REEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsRUFBRUEsU0FBU0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFNUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ1ZBLENBQUNBO1FBUmVELE1BQUdBLE1BUWxCQSxDQUFBQTtRQUVEQSxJQUFJQSxVQUFVQSxHQUFHQTtZQUNoQkEsZUFBZUE7WUFDZkEsTUFBTUE7U0FDTkEs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LENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBO1lBQ25DQSxDQUFDQTtZQUVTTiw0QkFBVUEsR0FBcEJBO2dCQUNDTzs7OztrQkFJRUE7WUFDSEEsQ0FBQ0E7WUFDRlAsY0FBQ0E7UUFBREEsQ0E3RkFGLEFBNkZDRSxJQUFBRjtJQUVGQSxDQUFDQSxFQW5JU0QsRUFBRUEsR0FBRkEsS0FBRUEsS0FBRkEsS0FBRUEsUUFtSVhBO0FBQURBLENBQUNBLEVBbklNLEVBQUUsS0FBRixFQUFFLFFBbUlSIiwiZmlsZSI6ImhvL3VpL3VpLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlIGhvLnVpIHtcclxuXHJcblx0ZXhwb3J0IGZ1bmN0aW9uIHJ1bihvcHRpb25zOklPcHRpb25zPW5ldyBPcHRpb25zKCkpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+IHtcclxuXHRcdG9wdGlvbnMgPSBuZXcgT3B0aW9ucyhvcHRpb25zKTtcclxuXHJcblx0XHRsZXQgcCA9IG9wdGlvbnMucHJvY2VzcygpXHJcblx0XHQudGhlbihoby5jb21wb25lbnRzLnJ1bi5iaW5kKGhvLmNvbXBvbmVudHMsIHVuZGVmaW5lZCkpXHJcblx0XHQudGhlbihoby5mbHV4LnJ1bi5iaW5kKGhvLmZsdXgsIHVuZGVmaW5lZCkpO1xyXG5cclxuXHRcdHJldHVybiBwO1xyXG5cdH1cclxuXHJcblx0bGV0IGNvbXBvbmVudHMgPSBbXHJcblx0XHRcIkZsdXhDb21wb25lbnRcIixcclxuXHRcdFwiVmlld1wiLFxyXG5cdF07XHJcblxyXG5cdGxldCBhdHRyaWJ1dGVzID0gW1xyXG5cdFx0XCJCaW5kXCIsXHJcblx0XHRcIkJpbmRCaVwiLFxyXG5cdFx0XCJEaXNhYmxlXCJcclxuXHRdO1xyXG5cclxuXHRsZXQgc3RvcmVzID0gW1xyXG5cclxuXHRdO1xyXG5cclxuXHRleHBvcnQgaW50ZXJmYWNlIElPcHRpb25zIHtcclxuXHRcdHJvb3Q6IHN0cmluZyB8IHR5cGVvZiBoby5jb21wb25lbnRzLkNvbXBvbmVudDsgLy9Sb290IGNvbXBvbmVudCB0byByZWdpc3RlcjtcclxuXHRcdHJvdXRlcjogc3RyaW5nIHwgdHlwZW9mIGhvLmZsdXguUm91dGVyOyAvL2FsdGVybmF0aXZlIHJvdXRlciBjbGFzc1xyXG5cdFx0bWFwOiBzdHJpbmcgfCBib29sZWFuOyAvLyBpZiBzZXQsIG1hcCBhbGwgaG8udWkgY29tcG9uZW50cyBpbiB0aGUgY29tcG9uZW50cHJvdmlkZXIgdG8gdGhlIGdpdmVuIHVybFxyXG5cdFx0ZGlyOiBib29sZWFuOyAvLyBzZXQgdXNlZGlyIGluIGhvLmNvbXBvbmVudHNcclxuXHRcdG1pbjogYm9vbGVhbjtcclxuXHRcdHByb2Nlc3M6ICgpPT5oby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+O1xyXG5cdH1cclxuXHJcblx0Y2xhc3MgT3B0aW9ucyBpbXBsZW1lbnRzIElPcHRpb25zIHtcclxuXHRcdHJvb3Q6IHN0cmluZyB8IHR5cGVvZiBoby5jb21wb25lbnRzLkNvbXBvbmVudCA9IFwiQXBwXCJcclxuXHRcdHJvdXRlcjogc3RyaW5nIHwgdHlwZW9mIGhvLmZsdXguUm91dGVyID0gaG8uZmx1eC5Sb3V0ZXI7XHJcblx0XHRtYXA6IHN0cmluZyB8IGJvb2xlYW4gPSB0cnVlO1xyXG5cdFx0bWFwRGVmYXVsdCA9IFwiYm93ZXJfY29tcG9uZW50cy9oby11aS9kaXN0L1wiO1xyXG5cdFx0ZGlyID0gdHJ1ZTtcclxuXHRcdG1pbiA9IGZhbHNlO1xyXG5cclxuXHRcdGNvbnN0cnVjdG9yKG9wdDogSU9wdGlvbnMgPSA8SU9wdGlvbnM+e30pIHtcclxuXHRcdFx0Zm9yKHZhciBrZXkgaW4gb3B0KSB7XHJcblx0XHRcdFx0dGhpc1trZXldID0gb3B0W2tleV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRwcm9jZXNzKCk6IGhvLnByb21pc2UuUHJvbWlzZTxhbnksIGFueT57XHJcblx0XHRcdHJldHVybiBoby5wcm9taXNlLlByb21pc2UuY3JlYXRlKHRoaXMucHJvY2Vzc0RpcigpKVxyXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NNaW4uYmluZCh0aGlzKSlcclxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzTWFwLmJpbmQodGhpcykpXHJcblx0XHRcdC50aGVuKHRoaXMucHJvY2Vzc1JvdXRlci5iaW5kKHRoaXMpKVxyXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NSb290LmJpbmQodGhpcykpXHJcblx0XHR9XHJcblxyXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NSb290KCkge1xyXG5cdFx0XHRsZXQgc2VsZiA9IHRoaXM7XHJcblx0XHRcdHJldHVybiBuZXcgaG8ucHJvbWlzZS5Qcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHRcdFx0XHRpZih0eXBlb2Ygc2VsZi5yb290ID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0aG8uY29tcG9uZW50cy5yZWdpc3RyeS5pbnN0YW5jZS5sb2FkQ29tcG9uZW50KDxzdHJpbmc+c2VsZi5yb290KVxyXG5cdFx0XHRcdFx0LnRoZW4ocmVzb2x2ZSlcclxuXHRcdFx0XHRcdC5jYXRjaChyZWplY3QpO1xyXG5cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aG8uY29tcG9uZW50cy5yZWdpc3RyeS5pbnN0YW5jZS5yZWdpc3Rlcig8dHlwZW9mIGhvLmNvbXBvbmVudHMuQ29tcG9uZW50PnNlbGYucm9vdClcclxuXHRcdFx0XHRcdHJlc29sdmUobnVsbCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRwcm90ZWN0ZWQgcHJvY2Vzc1JvdXRlcigpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+IHtcclxuXHRcdFx0bGV0IHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRyZXR1cm4gbmV3IGhvLnByb21pc2UuUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHNlbGYucm91dGVyID09PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0aG8uZmx1eC5TVE9SRVMubG9hZFN0b3JlKDxzdHJpbmc+c2VsZi5yb3V0ZXIsIGZhbHNlKVxyXG5cdFx0XHRcdFx0LnRoZW4ociA9PiByZXNvbHZlKHIpKVxyXG5cdFx0XHRcdFx0LmNhdGNoKHJlamVjdCk7XHJcblxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKG5ldyAoPHR5cGVvZiBoby5mbHV4LlJvdXRlcj5zZWxmLnJvdXRlcikoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0XHQudGhlbigocjogaG8uZmx1eC5Sb3V0ZXIpID0+IHtcclxuXHRcdFx0XHRoby5mbHV4LlJvdXRlciA9IDx0eXBlb2YgaG8uZmx1eC5Sb3V0ZXI+ci5jb25zdHJ1Y3RvcjtcclxuXHRcdFx0XHRoby5mbHV4LlNUT1JFUy5yZWdpc3RlcihyKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzTWFwKCk6IHZvaWQge1xyXG5cdFx0XHRpZih0eXBlb2YgdGhpcy5tYXAgPT09ICdib29sZWFuJykge1xyXG5cdFx0XHRcdGlmKCF0aGlzLm1hcClcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHR0aGlzLm1hcCA9IHRoaXMubWFwRGVmYXVsdDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y29tcG9uZW50cy5mb3JFYWNoKGMgPT4ge1xyXG5cdFx0XHRcdC8vaG8uY29tcG9uZW50cy5yZWdpc3RyeS5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcclxuXHRcdFx0XHRoby5jbGFzc2xvYWRlci5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVzLmZvckVhY2goYSA9PiB7XHJcblx0XHRcdFx0Ly9oby5jb21wb25lbnRzLnJlZ2lzdHJ5Lm1hcHBpbmdbYV0gPSB0aGlzLm1hcCArICdhdHRyaWJ1dGVzLycgKyBhICsgJy8nICsgYSArICcuanMnO1xyXG5cdFx0XHRcdGhvLmNsYXNzbG9hZGVyLm1hcHBpbmdbYV0gPSB0aGlzLm1hcCArICdhdHRyaWJ1dGVzLycgKyBhICsgJy8nICsgYSArICcuanMnO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHN0b3Jlcy5mb3JFYWNoKHMgPT4ge1xyXG5cdFx0XHRcdC8vaG8uZmx1eC5yZWdpc3RyeS5tYXBwaW5nW3NdID0gdGhpcy5tYXAgKyAnc3RvcmVzLycgKyBzICsgJy8nICsgcyArICcuanMnO1xyXG5cdFx0XHRcdGhvLmNsYXNzbG9hZGVyLm1hcHBpbmdbc10gPSB0aGlzLm1hcCArICdzdG9yZXMvJyArIHMgKyAnLycgKyBzICsgJy5qcyc7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzRGlyKCk6IHZvaWQge1xyXG5cdFx0XHRoby5jb21wb25lbnRzLnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LmFjdGlvbnMudXNlRGlyID0gdGhpcy5kaXI7XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NNaW4oKTogdm9pZCB7XHJcblx0XHRcdC8qXHJcblx0XHRcdGhvLmNvbXBvbmVudHMuY29tcG9uZW50cHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmNvbXBvbmVudHMuYXR0cmlidXRlcHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmZsdXguc3RvcmVwcm92aWRlci5pbnN0YW5jZS51c2VNaW4gPSB0aGlzLm1pbjtcclxuXHRcdFx0Ki9cclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==