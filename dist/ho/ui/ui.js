var ho;
(function (ho) {
    var ui;
    (function (ui) {
        function run(options) {
            if (options === void 0) { options = new Options(); }
            options = new Options(options);
            var p = options.process()
                .then(ho.components.run.bind(ho.components, undefined))
                .then(function () {
                return ho.flux.STORES.get(ho.flux.Router).init();
            });
            //.then(ho.flux.run.bind(ho.flux, undefined));
            return p;
        }
        ui.run = run;
        var components = [
            "FluxComponent",
            "View",
        ];
        var attributes = [
            "Bind",
            "BindBi",
            "Disable"
        ];
        var stores = [
            "Router"
        ];
        var actions = [
            "RouterActions"
        ];
        var Options = (function () {
            function Options(opt) {
                if (opt === void 0) { opt = {}; }
                this.root = "App";
                this.router = ho.flux.Router;
                this.map = true;
                this.mapDefault = "bower_components/ho-ui/dist/";
                this.dir = true;
                this.min = false;
                for (var key in opt) {
                    this[key] = opt[key];
                }
            }
            Options.prototype.process = function () {
                return ho.promise.Promise.create(this.processDir())
                    .then(this.processMin.bind(this))
                    .then(this.processMap.bind(this))
                    .then(this.processRouter.bind(this))
                    .then(this.processRoot.bind(this));
            };
            Options.prototype.processRoot = function () {
                var self = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof self.root === 'string') {
                        ho.components.registry.instance.loadComponent(self.root)
                            .then(resolve)
                            .catch(reject);
                    }
                    else {
                        ho.components.registry.instance.register(self.root);
                        resolve(null);
                    }
                });
            };
            Options.prototype.processRouter = function () {
                var self = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof self.router === 'string') {
                        ho.flux.STORES.loadStore(self.router, false)
                            .then(function (r) { return resolve(r); })
                            .catch(reject);
                    }
                    else {
                        resolve(new self.router());
                    }
                })
                    .then(function (r) {
                    ho.flux.Router = r.constructor;
                    ho.flux.STORES.register(r);
                });
            };
            Options.prototype.processMap = function () {
                var _this = this;
                if (typeof this.map === 'boolean') {
                    if (!this.map)
                        return;
                    else
                        this.map = this.mapDefault;
                }
                components.forEach(function (c) {
                    ho.classloader.mapping[c] = _this.map + 'components/' + c + '/' + c + '.js';
                });
                attributes.forEach(function (a) {
                    ho.classloader.mapping[a] = _this.map + 'attributes/' + a + '/' + a + '.js';
                });
                stores.forEach(function (s) {
                    ho.classloader.mapping[s] = _this.map + 'stores/' + s + '/' + s + '.js';
                });
                actions.forEach(function (a) {
                    ho.classloader.mapping[a] = _this.map + 'actions/' + a + '/' + a + '.js';
                });
            };
            Options.prototype.processDir = function () {
                ho.components.registry.useDir = this.dir;
                ho.flux.registry.useDir = this.dir;
                ho.flux.actions.useDir = this.dir;
            };
            Options.prototype.processMin = function () {
                /*
                ho.components.componentprovider.instance.useMin = this.min;
                ho.components.attributeprovider.instance.useMin = this.min;
                ho.flux.storeprovider.instance.useMin = this.min;
                */
            };
            return Options;
        })();
    })(ui = ho.ui || (ho.ui = {}));
})(ho || (ho = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvL3VpL3VpLnRzIl0sIm5hbWVzIjpbImhvIiwiaG8udWkiLCJoby51aS5ydW4iLCJoby51aS5PcHRpb25zIiwiaG8udWkuT3B0aW9ucy5jb25zdHJ1Y3RvciIsImhvLnVpLk9wdGlvbnMucHJvY2VzcyIsImhvLnVpLk9wdGlvbnMucHJvY2Vzc1Jvb3QiLCJoby51aS5PcHRpb25zLnByb2Nlc3NSb3V0ZXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNYXAiLCJoby51aS5PcHRpb25zLnByb2Nlc3NEaXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNaW4iXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sRUFBRSxDQTJJUjtBQTNJRCxXQUFPLEVBQUU7SUFBQ0EsSUFBQUEsRUFBRUEsQ0EySVhBO0lBM0lTQSxXQUFBQSxFQUFFQSxFQUFDQSxDQUFDQTtRQUViQyxhQUFvQkEsT0FBOEJBO1lBQTlCQyx1QkFBOEJBLEdBQTlCQSxjQUFxQkEsT0FBT0EsRUFBRUE7WUFDakRBLE9BQU9BLEdBQUdBLElBQUlBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1lBRS9CQSxJQUFJQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQSxPQUFPQSxFQUFFQTtpQkFDeEJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLEVBQUVBLFNBQVNBLENBQUNBLENBQUNBO2lCQUN0REEsSUFBSUEsQ0FBQ0E7Z0JBQ0xBLE1BQU1BLENBQUNBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLElBQUlBLEVBQUVBLENBQUNBO1lBQ2xEQSxDQUFDQSxDQUFDQSxDQUFBQTtZQUNGQSxBQUVBQSw4Q0FGOENBO1lBRTlDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNWQSxDQUFDQTtRQVhl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LEdBQUdBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBO2dCQUN6RUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDSkEsQ0FBQ0E7WUFFU0wsNEJBQVVBLEdBQXBCQTtnQkFDQ00sRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7Z0JBQ3pDQSxFQUFFQSxDQUFDQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQTtnQkFDbkNBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBO1lBQ25DQSxDQUFDQTtZQUVTTiw0QkFBVUEsR0FBcEJBO2dCQUNDTzs7OztrQkFJRUE7WUFDSEEsQ0FBQ0E7WUFDRlAsY0FBQ0E7UUFBREEsQ0E5RkFGLEFBOEZDRSxJQUFBRjtJQUVGQSxDQUFDQSxFQTNJU0QsRUFBRUEsR0FBRkEsS0FBRUEsS0FBRkEsS0FBRUEsUUEySVhBO0FBQURBLENBQUNBLEVBM0lNLEVBQUUsS0FBRixFQUFFLFFBMklSIiwiZmlsZSI6ImhvL3VpL3VpLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlIGhvLnVpIHtcclxuXHJcblx0ZXhwb3J0IGZ1bmN0aW9uIHJ1bihvcHRpb25zOklPcHRpb25zPW5ldyBPcHRpb25zKCkpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+IHtcclxuXHRcdG9wdGlvbnMgPSBuZXcgT3B0aW9ucyhvcHRpb25zKTtcclxuXHJcblx0XHRsZXQgcCA9IG9wdGlvbnMucHJvY2VzcygpXHJcblx0XHQudGhlbihoby5jb21wb25lbnRzLnJ1bi5iaW5kKGhvLmNvbXBvbmVudHMsIHVuZGVmaW5lZCkpXHJcblx0XHQudGhlbigoKT0+IHtcclxuXHRcdFx0cmV0dXJuIGhvLmZsdXguU1RPUkVTLmdldChoby5mbHV4LlJvdXRlcikuaW5pdCgpO1xyXG5cdFx0fSlcclxuXHRcdC8vLnRoZW4oaG8uZmx1eC5ydW4uYmluZChoby5mbHV4LCB1bmRlZmluZWQpKTtcclxuXHJcblx0XHRyZXR1cm4gcDtcclxuXHR9XHJcblxyXG5cdGxldCBjb21wb25lbnRzID0gW1xyXG5cdFx0XCJGbHV4Q29tcG9uZW50XCIsXHJcblx0XHRcIlZpZXdcIixcclxuXHRdO1xyXG5cclxuXHRsZXQgYXR0cmlidXRlcyA9IFtcclxuXHRcdFwiQmluZFwiLFxyXG5cdFx0XCJCaW5kQmlcIixcclxuXHRcdFwiRGlzYWJsZVwiXHJcblx0XTtcclxuXHJcblx0bGV0IHN0b3JlcyA9IFtcclxuXHRcdFwiUm91dGVyXCJcclxuXHRdO1xyXG5cclxuXHRsZXQgYWN0aW9ucyA9IFtcclxuXHRcdFwiUm91dGVyQWN0aW9uc1wiXHJcblx0XTtcclxuXHJcblx0ZXhwb3J0IGludGVyZmFjZSBJT3B0aW9ucyB7XHJcblx0XHRyb290OiBzdHJpbmcgfCB0eXBlb2YgaG8uY29tcG9uZW50cy5Db21wb25lbnQ7IC8vUm9vdCBjb21wb25lbnQgdG8gcmVnaXN0ZXI7XHJcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlcjsgLy9hbHRlcm5hdGl2ZSByb3V0ZXIgY2xhc3NcclxuXHRcdG1hcDogc3RyaW5nIHwgYm9vbGVhbjsgLy8gaWYgc2V0LCBtYXAgYWxsIGhvLnVpIGNvbXBvbmVudHMgaW4gdGhlIGNvbXBvbmVudHByb3ZpZGVyIHRvIHRoZSBnaXZlbiB1cmxcclxuXHRcdGRpcjogYm9vbGVhbjsgLy8gc2V0IHVzZWRpciBpbiBoby5jb21wb25lbnRzXHJcblx0XHRtaW46IGJvb2xlYW47XHJcblx0XHRwcm9jZXNzOiAoKT0+aG8ucHJvbWlzZS5Qcm9taXNlPGFueSwgYW55PjtcclxuXHR9XHJcblxyXG5cdGNsYXNzIE9wdGlvbnMgaW1wbGVtZW50cyBJT3B0aW9ucyB7XHJcblx0XHRyb290OiBzdHJpbmcgfCB0eXBlb2YgaG8uY29tcG9uZW50cy5Db21wb25lbnQgPSBcIkFwcFwiXHJcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlciA9IGhvLmZsdXguUm91dGVyO1xyXG5cdFx0bWFwOiBzdHJpbmcgfCBib29sZWFuID0gdHJ1ZTtcclxuXHRcdG1hcERlZmF1bHQgPSBcImJvd2VyX2NvbXBvbmVudHMvaG8tdWkvZGlzdC9cIjtcclxuXHRcdGRpciA9IHRydWU7XHJcblx0XHRtaW4gPSBmYWxzZTtcclxuXHJcblx0XHRjb25zdHJ1Y3RvcihvcHQ6IElPcHRpb25zID0gPElPcHRpb25zPnt9KSB7XHJcblx0XHRcdGZvcih2YXIga2V5IGluIG9wdCkge1xyXG5cdFx0XHRcdHRoaXNba2V5XSA9IG9wdFtrZXldO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvY2VzcygpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+e1xyXG5cdFx0XHRyZXR1cm4gaG8ucHJvbWlzZS5Qcm9taXNlLmNyZWF0ZSh0aGlzLnByb2Nlc3NEaXIoKSlcclxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzTWluLmJpbmQodGhpcykpXHJcblx0XHRcdC50aGVuKHRoaXMucHJvY2Vzc01hcC5iaW5kKHRoaXMpKVxyXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NSb3V0ZXIuYmluZCh0aGlzKSlcclxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzUm9vdC5iaW5kKHRoaXMpKVxyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzUm9vdCgpIHtcclxuXHRcdFx0bGV0IHNlbGYgPSB0aGlzO1xyXG5cdFx0XHRyZXR1cm4gbmV3IGhvLnByb21pc2UuUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRcdFx0aWYodHlwZW9mIHNlbGYucm9vdCA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGhvLmNvbXBvbmVudHMucmVnaXN0cnkuaW5zdGFuY2UubG9hZENvbXBvbmVudCg8c3RyaW5nPnNlbGYucm9vdClcclxuXHRcdFx0XHRcdC50aGVuKHJlc29sdmUpXHJcblx0XHRcdFx0XHQuY2F0Y2gocmVqZWN0KTtcclxuXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGhvLmNvbXBvbmVudHMucmVnaXN0cnkuaW5zdGFuY2UucmVnaXN0ZXIoPHR5cGVvZiBoby5jb21wb25lbnRzLkNvbXBvbmVudD5zZWxmLnJvb3QpXHJcblx0XHRcdFx0XHRyZXNvbHZlKG51bGwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NSb3V0ZXIoKTogaG8ucHJvbWlzZS5Qcm9taXNlPGFueSwgYW55PiB7XHJcblx0XHRcdGxldCBzZWxmID0gdGhpcztcclxuXHRcdFx0cmV0dXJuIG5ldyBoby5wcm9taXNlLlByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBzZWxmLnJvdXRlciA9PT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGhvLmZsdXguU1RPUkVTLmxvYWRTdG9yZSg8c3RyaW5nPnNlbGYucm91dGVyLCBmYWxzZSlcclxuXHRcdFx0XHRcdC50aGVuKHIgPT4gcmVzb2x2ZShyKSlcclxuXHRcdFx0XHRcdC5jYXRjaChyZWplY3QpO1xyXG5cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0cmVzb2x2ZShuZXcgKDx0eXBlb2YgaG8uZmx1eC5Sb3V0ZXI+c2VsZi5yb3V0ZXIpKCkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSlcclxuXHRcdFx0LnRoZW4oKHI6IGhvLmZsdXguUm91dGVyKSA9PiB7XHJcblx0XHRcdFx0aG8uZmx1eC5Sb3V0ZXIgPSA8dHlwZW9mIGhvLmZsdXguUm91dGVyPnIuY29uc3RydWN0b3I7XHJcblx0XHRcdFx0aG8uZmx1eC5TVE9SRVMucmVnaXN0ZXIocik7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRwcm90ZWN0ZWQgcHJvY2Vzc01hcCgpOiB2b2lkIHtcclxuXHRcdFx0aWYodHlwZW9mIHRoaXMubWFwID09PSAnYm9vbGVhbicpIHtcclxuXHRcdFx0XHRpZighdGhpcy5tYXApXHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0dGhpcy5tYXAgPSB0aGlzLm1hcERlZmF1bHQ7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGNvbXBvbmVudHMuZm9yRWFjaChjID0+IHtcclxuXHRcdFx0XHRoby5jbGFzc2xvYWRlci5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRhdHRyaWJ1dGVzLmZvckVhY2goYSA9PiB7XHJcblx0XHRcdFx0aG8uY2xhc3Nsb2FkZXIubWFwcGluZ1thXSA9IHRoaXMubWFwICsgJ2F0dHJpYnV0ZXMvJyArIGEgKyAnLycgKyBhICsgJy5qcyc7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0c3RvcmVzLmZvckVhY2gocyA9PiB7XHJcblx0XHRcdFx0aG8uY2xhc3Nsb2FkZXIubWFwcGluZ1tzXSA9IHRoaXMubWFwICsgJ3N0b3Jlcy8nICsgcyArICcvJyArIHMgKyAnLmpzJztcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRhY3Rpb25zLmZvckVhY2goYSA9PiB7XHJcblx0XHRcdFx0aG8uY2xhc3Nsb2FkZXIubWFwcGluZ1thXSA9IHRoaXMubWFwICsgJ2FjdGlvbnMvJyArIGEgKyAnLycgKyBhICsgJy5qcyc7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHByb3RlY3RlZCBwcm9jZXNzRGlyKCk6IHZvaWQge1xyXG5cdFx0XHRoby5jb21wb25lbnRzLnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LnJlZ2lzdHJ5LnVzZURpciA9IHRoaXMuZGlyO1xyXG5cdFx0XHRoby5mbHV4LmFjdGlvbnMudXNlRGlyID0gdGhpcy5kaXI7XHJcblx0XHR9XHJcblxyXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NNaW4oKTogdm9pZCB7XHJcblx0XHRcdC8qXHJcblx0XHRcdGhvLmNvbXBvbmVudHMuY29tcG9uZW50cHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmNvbXBvbmVudHMuYXR0cmlidXRlcHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XHJcblx0XHRcdGhvLmZsdXguc3RvcmVwcm92aWRlci5pbnN0YW5jZS51c2VNaW4gPSB0aGlzLm1pbjtcclxuXHRcdFx0Ki9cclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==