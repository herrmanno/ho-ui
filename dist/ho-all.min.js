var ho;!function(t){var e;!function(t){var e=function(){function t(t){this.data=void 0,this.onResolve=void 0,this.onReject=void 0,this.resolved=!1,this.rejected=!1,this.done=!1,this.ret=void 0,"function"==typeof t&&t.call(arguments.callee,function(t){this.resolve(t)}.bind(this),function(t){this.reject(t)}.bind(this))}return t.prototype.set=function(t){if(this.done)throw"Promise is already resolved / rejected";this.data=t},t.prototype.resolve=function(t){this.set(t),this.resolved=this.done=!0,"function"==typeof this.onResolve&&this._resolve()},t.prototype._resolve=function(){void 0===this.ret&&(this.ret=new t);var e=this.onResolve(this.data);e&&e instanceof t?e.then(this.ret.resolve.bind(this.ret),this.ret.reject.bind(this.ret)):this.ret.resolve(e)},t.prototype.reject=function(t){this.set(t),this.rejected=this.done=!0,"function"==typeof this.onReject&&this.onReject(this.data),this.ret&&this.ret.reject(this.data)},t.prototype._reject=function(){void 0===this.ret&&(this.ret=new t),"function"==typeof this.onReject&&this.onReject(this.data),this.ret.reject(this.data)},t.prototype.then=function(e,i){return void 0===this.ret&&(this.ret=new t),e&&"function"==typeof e&&(this.onResolve=e),i&&"function"==typeof i&&(this.onReject=i),this.resolved&&this._resolve(),this.rejected&&this._reject(),this.ret},t.prototype["catch"]=function(t){this.onReject=t,this.rejected&&this._reject()},t.all=function(e){var i=new t,n=[];return 0===e.length?i.resolve():e.forEach(function(t,o){t.then(function(t){if(!i.done){n[o]=t;var s=e.reduce(function(t,e){return t&&e.resolved},!0);s&&i.resolve(n)}})["catch"](function(t){i.reject(t)})}),i},t.chain=function(e){function i(){if(!n.done){var t=e.length?e.shift():n;t.then(function(t){o.push(t),i()},function(t){n.reject(t)})}}var n=new t,o=[];return i(),n},t.create=function(e){if(e instanceof t)return e;var i=new t;return i.resolve(e),i},t}();t.Promise=e}(e=t.promise||(t.promise={}))}(ho||(ho={}));
var ho;!function(n){var t;!function(n){function t(n,t,i){new o(n,t,i)}n.watch=t;var o=function(){function n(n,t,o){var i=this;this.obj=n,this.name=t,this.handler=o,this.oldVal=this.copy(n[t]),this.watch(function(o){i.oldVal!==n[t]&&(i.handler.call(null,n,t,i.oldVal,n[t],o),i.oldVal=i.copy(n[t]))})}return n.prototype.watch=function(n){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)},o=function(i){n(i),t(o)};t(o)},n.prototype.copy=function(n){return JSON.parse(JSON.stringify(n))},n}()}(t=n.watch||(n.watch={}))}(ho||(ho={}));
var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise;e.mapping={};var r=function(){function r(){this.useMin=!1}return r.prototype.resolve=function(n){return e.mapping[n]?e.mapping[n]:(t.components.dir&&(n+="."+n.split(".").pop()),n=n.split(".").join("/"),this.useMin?"components/"+n+".min.js":"components/"+n+".js")},r.prototype.getComponent=function(t){var e=this;return new n(function(n,r){var o=e.resolve(t),i=document.createElement("script");i.onload=function(){"function"==typeof this.get(t)?n(this.get(t)):r("Error while loading Component "+t)}.bind(e),i.src=o,document.getElementsByTagName("head")[0].appendChild(i)})},r.prototype.get=function(t){var e=window;return t.split(".").forEach(function(t){e=e[t]}),e},r}();e.ComponentProvider=r,e.instance=new r}(n=e.componentprovider||(e.componentprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);n.prototype=e.prototype,t.prototype=new n},ho;!function(t){var e;!function(e){var n=function(){function t(t,n){this.element=t,this.component=e.Component.getComponent(t),this.value=n,this.init()}return t.prototype.init=function(){},Object.defineProperty(t.prototype,"name",{get:function(){return t.getName(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(){},t.getName=function(e){return e instanceof t?e.constructor.toString().match(/\w+/g)[1]:e.toString().match(/\w+/g)[1]},t}();e.Attribute=n;var r=function(e){function n(t,n){e.call(this,t,n),this.r=/#(.+?)#/g;var r=this.value.match(this.r)||[];r.map(function(t){t=t.substr(1,t.length-2),this.watch(t)}.bind(this)),this.value=this.value.replace(/#/g,"")}return __extends(n,e),n.prototype.watch=function(e){var n=e.split("."),r=n.pop(),o=this.component;n.map(function(t){o=o[t]}),t.watch.watch(o,r,this.update.bind(this))},n.prototype.eval=function(t){var e=this.component;return e=new Function(Object.keys(e).toString(),"return "+t).apply(null,Object.keys(e).map(function(t){return e[t]}))},n}(n);e.WatchAttribute=r}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise;e.mapping={};var r=function(){function r(){this.useMin=!1}return r.prototype.resolve=function(n){return e.mapping[n]?e.mapping[n]:(t.components.dir&&(n+="."+n.split(".").pop()),n=n.split(".").join("/"),this.useMin?"attributes/"+n+".min.js":"attributes/"+n+".js")},r.prototype.getAttribute=function(t){var e=this;return new n(function(n,r){var o=e.resolve(t),i=document.createElement("script");i.onload=function(){"function"==typeof window[t]?n(window[t]):r("Error while loading Attribute "+t)},i.src=o,document.getElementsByTagName("head")[0].appendChild(i)})},r}();e.AttributeProvider=r,e.instance=new r}(n=e.attributeprovider||(e.attributeprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(n){var r=t.promise.Promise,o=function(){function n(){this.components=[],this.attributes=[]}return n.prototype.register=function(t){t.prototype instanceof e.Component?(this.components.push(t),document.createElement(e.Component.getName(t))):t.prototype instanceof e.Attribute&&this.attributes.push(t)},n.prototype.run=function(){var t=this.initComponent.bind(this),e=this.components.map(function(e){return t(e)});return r.all(e)},n.prototype.initComponent=function(t,n){void 0===n&&(n=document);var o=Array.prototype.map.call(n.querySelectorAll(e.Component.getName(t)),function(e){return new t(e)._init()});return r.all(o)},n.prototype.initElement=function(t){var e=this.initComponent.bind(this),n=Array.prototype.map.call(this.components,function(n){return e(n,t)});return r.all(n)},n.prototype.hasComponent=function(t){return this.components.filter(function(n){return e.Component.getName(n)===t}).length>0},n.prototype.hasAttribute=function(t){return this.attributes.filter(function(n){return e.Attribute.getName(n)===t}).length>0},n.prototype.getAttribute=function(t){return this.attributes.filter(function(n){return e.Attribute.getName(n)===t})[0]},n.prototype.loadComponent=function(e){var n=this;return this.getParentOfComponent(e).then(function(t){return n.hasComponent(t)||"ho.components.Component"===t?!0:n.loadComponent(t)}).then(function(n){return t.components.componentprovider.instance.getComponent(e)}).then(function(t){return n.register(t),t})},n.prototype.loadAttribute=function(e){var n=this;return this.getParentOfAttribute(e).then(function(t){return n.hasAttribute(t)||"ho.components.Attribute"===t||"ho.components.WatchAttribute"===t?!0:n.loadAttribute(t)}).then(function(n){return t.components.attributeprovider.instance.getAttribute(e)}).then(function(t){return n.register(t),t})},n.prototype.getParentOfComponent=function(e){return this.getParentOfClass(t.components.componentprovider.instance.resolve(e))},n.prototype.getParentOfAttribute=function(e){return this.getParentOfClass(t.components.attributeprovider.instance.resolve(e))},n.prototype.getParentOfClass=function(t){return new r(function(e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState){var t=r.responseText;if(200==r.status){var o=t.match(/}\)\((.*)\);/);e(null!==o?o[1]:null)}else n(t)}},r.open("GET",t),r.send()})},n}();n.Registry=o,n.instance=new o}(n=e.registry||(e.registry={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){function n(){return t.components.registry.instance.run()}function r(e){t.components.registry.instance.register(e)}e.run=n,e.register=r,e.dir=!1}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.promise.Promise,r=function(){function e(){this.cache={}}return e.prototype.resolve=function(e){return t.components.dir&&(e+="."+e.split(".").pop()),e=e.split(".").join("/"),"components/"+e+".html"},e.prototype.getHTML=function(t){var e=this;return new n(function(n,r){if("string"==typeof e.cache[t])return n(e.cache[t]);var o=e.resolve(t),i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState){var e=i.responseText;200==i.status?n(e):r("Error while loading html for Component "+t)}},i.open("GET",o,!0),i.send()})},e}();e.HtmlProvider=r,e.instance=new r}(n=e.htmlprovider||(e.htmlprovider={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e;!function(t){function e(t){return o++,i[o]=t,o}function n(t){return i[t]}function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i[t].apply(i,e)}var o=-1,i=[];t.set=e,t.get=n,t.call=r}(e=t.temp||(t.temp={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n;!function(e){var n=t.components.registry.instance,r=function(){function t(){this.children=[]}return t}(),o=function(){function e(){this.r={tag:/<([^>]*?(?:(?:('|")[^'"]*?\2)[^>]*?)*)>/,repeat:/repeat=["|'].+["|']/,type:/[\s|/]*(.*?)[\s|\/|>]/,text:/(?:.|[\r\n])*?[^"'\\]</m},this.voids=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],this.cache={}}return e.prototype.render=function(t){if("boolean"!=typeof t.html||t.html){var e=t.name,n=this.cache[e]=this.cache[e]||this.parse(t.html).root;n=this.renderRepeat(this.copyNode(n),t);var r=this.domToString(n,-1);t.element.innerHTML=r}},e.prototype.parse=function(t,e){void 0===e&&(e=new r);for(var o;null!==(o=this.r.tag.exec(t));){var i,s,a,p,u,c,h;if(0!==o.index?(i=t.match(this.r.text)[0],i=i.substr(0,i.length-1),s="TEXT",p=!1,u=!0,c=!1):(i=o[1].trim(),s=(i+">").match(this.r.type)[1],a="/"===i[0],p=this.isVoid(s),u=p||"/"===i[i.length-1],c=!!i.match(this.r.repeat),u&&n.hasComponent(s)&&(u=!1,i=i.substr(0,i.length-1)+" ",h=!0)),t=t.slice(i.length+("TEXT"===s?0:2)),a)break;if(e.children.push({parent:e,html:i,type:s,isVoid:p,selfClosing:u,repeat:c,children:[]}),!h&&!u){var l=this.parse(t,e.children[e.children.length-1]);t=l.html,e.children.pop(),e.children.push(l.root)}o=t.match(this.r.tag)}return{root:e,html:t}},e.prototype.renderRepeat=function(t,e){e=[].concat(e);for(var n=0;n<t.children.length;n++){var r=t.children[n];if(r.repeat){var o,i=/repeat=["|']\s*(\S+)\s+as\s+(\S+?)["|']/,s=r.html.match(i).slice(1),a=s[1];if(a.indexOf(",")>-1){var p=a.split(",");a=p[0].trim(),o=p[1].trim()}var u=this.evaluate(e,s[0]),c=[];u.forEach(function(t,n){var i={};i[a]=t,i[o]=n;var s=[].concat(e);s.unshift(i);var p=this.copyNode(r);p.repeat=!1,p.html=p.html.replace(this.r.repeat,""),p.html=this.repl(p.html,s),p=this.renderRepeat(p,s),c.push(p)}.bind(this)),c.forEach(function(e){t.children.splice(t.children.indexOf(r),0,e)}),t.children.splice(t.children.indexOf(r),1)}else r.html=this.repl(r.html,e),r=this.renderRepeat(r,e),t.children[n]=r}return t},e.prototype.domToString=function(t,e){e=e||0;var n="",r="	";return t.html&&(n+=new Array(e).join(r),"TEXT"!==t.type?t.selfClosing&&!t.isVoid?(n+="<"+t.html.substr(0,--t.html.length)+">",n+="</"+t.type+">\n"):n+="<"+t.html+">":n+=t.html),n&&(n+="\n"),t.children.length&&(n+=t.children.map(function(n){return this.domToString(n,e+(t.type?1:2))}.bind(this)).join("\n")),t.type&&"TEXT"!==t.type&&!t.selfClosing&&(n+=new Array(e).join(r),n+="</"+t.type+">\n"),n},e.prototype.repl=function(t,e){var n=/{(.+?)}}?/g,r=t.match(n);if(!r)return t;for(;r.length;){var o=r[0];o=o.substr(1,o.length-2);var i=this.evaluate(e,o);void 0!==i&&("function"==typeof i&&(i="ho.components.Component.getComponent(this)."+o),t=t.replace(r[0],i)),r=r.slice(1)}return t},e.prototype.evaluate=function(t,e){return"{"===e[0]&&"}"===e[--e.length]?this.evaluateExpression(t,e.substr(1,e.length-2)):"#"===e[0]?this.evaluateFunction(t,e.substr(1)):this.evaluateValue(t,e)},e.prototype.evaluateValue=function(t,e){return this.evaluateValueAndModel(t,e).value},e.prototype.evaluateValueAndModel=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,r=void 0;n<t.length&&void 0===r;){r=t[n];try{r=new Function("model","return model['"+e.split(".").join("']['")+"']")(r)}catch(o){r=void 0}finally{n++}}return{value:r,model:t[--n]}},e.prototype.evaluateExpression=function(t,e){-1==t.indexOf(window)&&t.push(window);for(var n=0,r=void 0;n<t.length&&void 0===r;){r=t[n];try{r=new Function(Object.keys(r).toString(),"return "+e).apply(null,Object.keys(r).map(function(t){return r[t]}))}catch(o){r=void 0}finally{n++}}return r},e.prototype.evaluateFunction=function(e,n){var r=this.evaluateExpression.bind(this,e),o=n.split("("),i=o[0],s=o[1];s=s.substr(0,--s.length);var a=this.evaluateValueAndModel(e,i),p=a.value,u=a.model,c=p,h=s.split(".").map(function(t){return 0===t.indexOf("#")?t.substr(1):r(t)});c=c.bind.apply(c,[u].concat(h));var l=t.components.temp.set(c),m="ho.components.temp.call("+l+")";return m},e.prototype.copyNode=function(t){var e=this.copyNode.bind(this),n={parent:t.parent,html:t.html,type:t.type,selfClosing:t.selfClosing,repeat:t.repeat,children:t.children.map(e)};return n},e.prototype.isVoid=function(t){return-1!==this.voids.indexOf(t.toLowerCase())},e}();e.Renderer=o,e.instance=new o}(n=e.renderer||(e.renderer={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(){}return t.prototype.applyStyle=function(t,e){var n=this;void 0===e&&(e=t.style);var r=this.parseStyle(t.style);r.forEach(function(e){n.applyStyleBlock(t,e)})},t.prototype.applyStyleBlock=function(t,e){var n=this;"this"===e.selector.trim().toLowerCase()?e.rules.forEach(function(e){n.applyRule(t.element,e)}):Array.prototype.forEach.call(t.element.querySelectorAll(e.selector),function(t){e.rules.forEach(function(e){n.applyRule(t,e)})})},t.prototype.applyRule=function(t,e){var n=e.property.replace(/-(\w)/g,function(t,e){return e.toUpperCase()}).trim();t.style[n]=e.value},t.prototype.parseStyle=function(t){var e=/(.+?)\s*{(.*?)}/gm,n=/(.+?)\s?:(.+?);/gm;t=t.replace(/\n/g,"");var r=(t.match(e)||[]).map(function(t){if(!t.match(e))return null;var r=e.exec(t),o=(r[0],r[1]),i=r[2],s=(i.match(n)||[]).map(function(t){if(!t.match(n))return null;var e=n.exec(t),r=(e[0],e[1]),o=e[2];return{property:r,value:o}}).filter(function(t){return null!==t});return{selector:o,rules:s}}).filter(function(t){return null!==t});return r},t}();t.instance=new e}(e=t.styler||(t.styler={}))}(e=t.components||(t.components={}))}(ho||(ho={}));var ho;!function(t){var e;!function(e){var n=t.components.registry.instance,r=t.components.htmlprovider.instance,o=t.components.renderer.instance,i=t.promise.Promise,s=function(){function t(t){this.html="",this.style="",this.properties=[],this.attributes=[],this.requires=[],this.children={},this.element=t,this.element.component=this,this.original_innerHTML=t.innerHTML}return Object.defineProperty(t.prototype,"name",{get:function(){return t.getName(this)},enumerable:!0,configurable:!0}),t.prototype.getName=function(){return this.name},t.prototype.getParent=function(){return t.getComponent(this.element.parentNode)},t.prototype._init=function(){var t=this.render.bind(this);this.initProperties();var e=[this.initHTML(),i.create(this.init()),this.loadRequirements()],n=new i;return i.all(e).then(function(){n.resolve(),t()})["catch"](function(t){throw n.reject(t),t}),n},t.prototype.init=function(){},t.prototype.update=function(){return void 0},t.prototype.render=function(){o.render(this),n.initElement(this.element).then(function(){this.initChildren(),this.initStyle(),this.initAttributes(),this.update()}.bind(this))},t.prototype.initStyle=function(){"undefined"!=typeof this.style&&null!==this.style&&("string"!=typeof this.style||0!==this.style.length)&&e.styler.instance.applyStyle(this)},t.prototype.initHTML=function(){var t=new i,e=this;return"undefined"==typeof this.html?(this.html="",t.resolve()):-1!==this.html.indexOf(".html",this.html.length-".html".length)?r.getHTML(this.name).then(function(n){e.html=n,t.resolve()})["catch"](t.reject):t.resolve(),t},t.prototype.initProperties=function(){this.properties.forEach(function(t){if("object"==typeof t){if(this.properties[t.name]=this.element[t.name]||this.element.getAttribute(t.name)||t["default"],void 0===this.properties[t.name]&&t.required===!0)throw"Property "+t.name+" is required but not provided"}else"string"==typeof t&&(this.properties[t]=this.element[t]||this.element.getAttribute(t))}.bind(this))},t.prototype.initChildren=function(){for(var t=this.element.querySelectorAll("*"),e=0;e<t.length;e++){var n=t[e];n.id&&(this.children[n.id]=n),n.tagName&&(this.children[n.tagName]=this.children[n.tagName]||[]),this.children[n.tagName].push(n)}},t.prototype.initAttributes=function(){var t=this;this.attributes.forEach(function(e){var r=n.getAttribute(e);Array.prototype.forEach.call(t.element.querySelectorAll("*["+e+"]"),function(t){var n=t.hasOwnProperty(e)?t[e]:t.getAttribute(e);"string"==typeof n&&""===n&&(n=void 0),new r(t,n).update()})})},t.prototype.loadRequirements=function(){var t=this.requires.filter(function(t){return!n.hasComponent(t)}).map(function(t){return n.loadComponent(t)}),e=this.attributes.filter(function(t){return!n.hasAttribute(t)}).map(function(t){return n.loadAttribute(t)}),r=t.concat(e);return i.all(r)},t.getComponent=function(t){for(;!t.component;)t=t.parentNode;return t.component},t.getName=function(e){return e instanceof t?e.constructor.toString().match(/\w+/g)[1]:e.toString().match(/\w+/g)[1]},t}();e.Component=s}(e=t.components||(t.components={}))}(ho||(ho={}));
var ho;!function(t){var n;!function(t){var n=function(){function t(){this.prefix="ID_",this.lastID=1,this.callbacks={}}return t.prototype.register=function(t,n){var e=this.prefix+this.lastID++;return this.callbacks[e]=n?t.bind(n):t,e},t.prototype.unregister=function(t){if(!this.callbacks[t])throw"Could not unregister callback for id "+t;delete this.callbacks[t]},t}();t.CallbackHolder=n}(n=t.flux||(t.flux={}))}(ho||(ho={}));var ho;!function(t){var n;!function(n){var e;!function(n){var e=t.promise.Promise,r=function(){function t(){this.useMin=!1}return t.prototype.resolve=function(){return this.useMin?"states.min.js":"states.js"},t.prototype.getStates=function(t){var n=this;return void 0===t&&(t="States"),new e(function(e,r){var i=n.resolve(),o=document.createElement("script");o.onload=function(){e(new window[t])},o.onerror=function(t){r(t)},o.src=i,document.getElementsByTagName("head")[0].appendChild(o)})},t}();n.instance=new r}(e=n.stateprovider||(n.stateprovider={}))}(n=t.flux||(t.flux={}))}(ho||(ho={}));var ho;!function(t){var n;!function(n){var e;!function(e){var r=t.promise.Promise;e.mapping={};var i=function(){function i(){this.useMin=!1}return i.prototype.resolve=function(n){return e.mapping[n]?e.mapping[n]:(t.flux.dir&&(n+="."+n.split(".").pop()),n=n.split(".").join("/"),this.useMin?"stores/"+n+".min.js":"stores/"+n+".js")},i.prototype.getStore=function(t){var e=this;return void 0!==window[t]&&window[t].prototype instanceof n.Store?r.create(window[t]):new r(function(n,r){var i=e.resolve(t),o=document.createElement("script");o.onload=function(){"function"==typeof this.get(t)?n(this.get(t)):r("Error while loading Store "+t)}.bind(e),o.src=i,document.getElementsByTagName("head")[0].appendChild(o)})},i.prototype.get=function(t){var n=window;return t.split(".").forEach(function(t){n=n[t]}),n},i}();e.instance=new i}(e=n.storeprovider||(n.storeprovider={}))}(n=t.flux||(t.flux={}))}(ho||(ho={}));var ho;!function(t){var n;!function(n){var e=t.promise.Promise,r=function(){function r(){this.stores={}}return r.prototype.register=function(t){return this.stores[t.name]=t,t},r.prototype.get=function(t){var n=t.toString().match(/\w+/g)[1];return this.stores[n]},r.prototype.loadStore=function(e){var r=this,i=this.getParentOfStore(e).then(function(t){return r.stores[t]instanceof n.Store||"ho.flux.Store"===t?!0:r.loadStore(t)}).then(function(n){return t.flux.storeprovider.instance.getStore(e)}).then(function(t){return r.register(new t).init()}).then(function(){return r.stores[e]});return i},r.prototype.getParentOfStore=function(n){return new e(function(e,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState){var t=i.responseText;if(200==i.status){var n=t.match(/}\)\((.*)\);/);e(null!==n?n[1]:null)}else r(t)}},i.open("GET",t.flux.storeprovider.instance.resolve(n)),i.send()})},r}();n.Storeregistry=r}(n=t.flux||(t.flux={}))}(ho||(ho={}));var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);e.prototype=n.prototype,t.prototype=new e},ho;!function(t){var n;!function(n){var e=function(n){function e(){n.call(this),this.handlers={},this.id=t.flux.DISPATCHER.register(this.handle.bind(this)),t.flux.STORES.register(this)}return __extends(e,n),e.prototype.init=function(){},Object.defineProperty(e.prototype,"name",{get:function(){return this.constructor.toString().match(/\w+/g)[1]},enumerable:!0,configurable:!0}),e.prototype.register=function(t,e){return n.prototype.register.call(this,t,e)},e.prototype.on=function(t,n){this.handlers[t]=n},e.prototype.handle=function(t){"function"==typeof this.handlers[t.type]&&this.handlers[t.type](t.data)},e.prototype.changed=function(){for(var t in this.callbacks){var n=this.callbacks[t];n&&n(this.data)}},e}(n.CallbackHolder);n.Store=e}(n=t.flux||(t.flux={}))}(ho||(ho={}));var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);e.prototype=n.prototype,t.prototype=new e},ho;!function(t){var n;!function(n){var e=t.promise.Promise,r=function(r){function i(){r.call(this),this.mapping=null}return __extends(i,r),i.prototype.init=function(){this.on("STATE",this.onStateChangeRequested.bind(this));var t=this.onHashChange.bind(this);return this.initStates().then(function(){window.onhashchange=t,t()})},i.prototype.go=function(n){t.flux.DISPATCHER.dispatch({type:"STATE",data:n})},i.prototype.initStates=function(){return n.stateprovider.instance.getStates().then(function(t){this.mapping=t.states}.bind(this))},i.prototype.getStateFromName=function(t){return this.mapping.filter(function(n){return n.name===t})[0]},i.prototype.onStateChangeRequested=function(t){var n=this.getStateFromName(t.state),r=this.urlFromState(n.url,t.args);if(!(this.data&&this.data.state&&this.data.state.name===t.state&&this.equals(this.data.args,t.args)&&r===window.location.hash.substr(1))){n.redirect&&(n=this.getStateFromName(n.redirect));var i="function"==typeof n.before?n.before(t):e.create(void 0);i.then(function(){var e=!!t.extern;this.data={state:n,args:t.args,extern:e};var r=this.urlFromState(n.url,t.args);this.setUrl(r),this.changed()}.bind(this),function(t){this.onStateChangeRequested(t)}.bind(this))}},i.prototype.onHashChange=function(){var n=this.stateFromUrl(window.location.hash.substr(1));t.flux.DISPATCHER.dispatch({type:"STATE",data:{state:n.state,args:n.args,extern:!0}})},i.prototype.setUrl=function(t){if(window.location.hash.substr(1)!==t){var n=window.onhashchange;window.onhashchange=null,window.location.hash=t,window.onhashchange=n}},i.prototype.regexFromUrl=function(t){for(var n=/:([\w]+)/;t.match(n);)t=t.replace(n,"([^/]+)");return t+"$"},i.prototype.argsFromUrl=function(t,n){var e=this.regexFromUrl(t),r=t.match(e).slice(1),i=n.match(e).slice(1),o={};return r.forEach(function(t,n){o[t.substr(1)]=i[n]}),o},i.prototype.stateFromUrl=function(t){var n=this,e=void 0;if(this.mapping.forEach(function(r){if(!e){var i=n.regexFromUrl(r.url);if(t.match(i)){var o=n.argsFromUrl(r.url,t);e={state:r.name,args:o,extern:!1}}}}),!e)throw"No State found for url "+t;return e},i.prototype.urlFromState=function(t,n){for(var e=/:([\w]+)/;t.match(e);)t=t.replace(e,function(t){return n[t.substr(1)]});return t},i.prototype.equals=function(t,n){return JSON.stringify(t)===JSON.stringify(n)},i}(n.Store);n.Router=r}(n=t.flux||(t.flux={}))}(ho||(ho={}));var __extends=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);e.prototype=n.prototype,t.prototype=new e},ho;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments),this.isPending={},this.isHandled={},this.isDispatching=!1,this.pendingPayload=null}return __extends(n,t),n.prototype.waitFor=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];if(!this.isDispatching)throw"Dispatcher.waitFor(...): Must be invoked while dispatching.";for(var e=0;e<t.length;e++){var r=t[e];if(this.isPending[r]){if(!this.isHandled[r])throw"waitFor(...): Circular dependency detected while wating for "+r}else{if(!this.callbacks[r])throw"waitFor(...): "+r+" does not map to a registered callback.";this.invokeCallback(r)}}},n.prototype.dispatch=function(t){if(this.isDispatching)throw"Cannot dispatch in the middle of a dispatch.";this.startDispatching(t);try{for(var n in this.callbacks)this.isPending[n]||this.invokeCallback(n)}finally{this.stopDispatching()}},n.prototype.invokeCallback=function(t){this.isPending[t]=!0,this.callbacks[t](this.pendingPayload),this.isHandled[t]=!0},n.prototype.startDispatching=function(t){for(var n in this.callbacks)this.isPending[n]=!1,this.isHandled[n]=!1;this.pendingPayload=t,this.isDispatching=!0},n.prototype.stopDispatching=function(){this.pendingPayload=null,this.isDispatching=!1},n}(t.CallbackHolder);t.Dispatcher=n}(n=t.flux||(t.flux={}))}(ho||(ho={}));var ho;!function(t){var n;!function(t){function n(){return t.STORES.get(t.Router).init()}t.DISPATCHER=new t.Dispatcher,t.STORES=new t.Storeregistry,t.dir=!1,t.run=n}(n=t.flux||(t.flux={}))}(ho||(ho={}));
var ho;
(function (ho) {
    var ui;
    (function (ui) {
        function run(options) {
            if (options === void 0) { options = new Options(); }
            options = new Options(options);
            var p = options.process()
                .then(ho.components.run)
                .then(ho.flux.run);
            return p;
        }
        ui.run = run;
        var components = [
            "Stored",
            "View",
        ];
        var attributes = [
            "Bind",
            "BindBi",
        ];
        var stores = [];
        var Options = (function () {
            function Options(opt) {
                if (opt === void 0) { opt = {}; }
                this.root = "App";
                this.router = ho.flux.Router;
                this.map = true;
                this.mapDefault = "bower_components/ho-ui/dist/";
                this.dir = true;
                this.min = false;
                for (var key in opt) {
                    this[key] = opt[key];
                }
            }
            Options.prototype.process = function () {
                return ho.promise.Promise.create(this.processDir())
                    .then(this.processMin.bind(this))
                    .then(this.processMap.bind(this))
                    .then(this.processRouter.bind(this))
                    .then(this.processRoot.bind(this));
            };
            Options.prototype.processRoot = function () {
                var _this = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof _this.root === 'string') {
                        ho.components.registry.instance.loadComponent(_this.root)
                            .then(resolve)
                            .catch(reject);
                    }
                    else {
                        ho.components.registry.instance.register(_this.root);
                        resolve(null);
                    }
                });
            };
            Options.prototype.processRouter = function () {
                var _this = this;
                return new ho.promise.Promise(function (resolve, reject) {
                    if (typeof _this.router === 'string') {
                        ho.flux.STORES.loadStore(_this.router)
                            .then(resolve)
                            .catch(reject);
                    }
                    else {
                        resolve(new _this.router());
                    }
                });
            };
            Options.prototype.processMap = function () {
                var _this = this;
                if (typeof this.map === 'boolean') {
                    if (!this.map)
                        return;
                    else
                        this.map = this.mapDefault;
                }
                components.forEach(function (c) {
                    ho.components.componentprovider.mapping[c] = _this.map + 'components/' + c + '/' + c + '.js';
                });
                attributes.forEach(function (a) {
                    ho.components.attributeprovider.mapping[a] = _this.map + 'attributes/' + a + '/' + a + '.js';
                });
                stores.forEach(function (s) {
                    ho.flux.storeprovider.mapping[s] = _this.map + 'stores/' + s + '/' + s + '.js';
                });
            };
            Options.prototype.processDir = function () {
                ho.components.dir = this.dir;
            };
            Options.prototype.processMin = function () {
                ho.components.componentprovider.instance.useMin = this.min;
                ho.components.attributeprovider.instance.useMin = this.min;
                ho.flux.storeprovider.instance.useMin = this.min;
            };
            return Options;
        })();
    })(ui = ho.ui || (ho.ui = {}));
})(ho || (ho = {}));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVpLnRzIl0sIm5hbWVzIjpbImhvIiwiaG8udWkiLCJoby51aS5ydW4iLCJoby51aS5PcHRpb25zIiwiaG8udWkuT3B0aW9ucy5jb25zdHJ1Y3RvciIsImhvLnVpLk9wdGlvbnMucHJvY2VzcyIsImhvLnVpLk9wdGlvbnMucHJvY2Vzc1Jvb3QiLCJoby51aS5PcHRpb25zLnByb2Nlc3NSb3V0ZXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNYXAiLCJoby51aS5PcHRpb25zLnByb2Nlc3NEaXIiLCJoby51aS5PcHRpb25zLnByb2Nlc3NNaW4iXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sRUFBRSxDQXFIUjtBQXJIRCxXQUFPLEVBQUU7SUFBQ0EsSUFBQUEsRUFBRUEsQ0FxSFhBO0lBckhTQSxXQUFBQSxFQUFFQSxFQUFDQSxDQUFDQTtRQUViQyxhQUFvQkEsT0FBOEJBO1lBQTlCQyx1QkFBOEJBLEdBQTlCQSxjQUFxQkEsT0FBT0EsRUFBRUE7WUFDakRBLE9BQU9BLEdBQUdBLElBQUlBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLENBQUNBO1lBRS9CQSxJQUFJQSxDQUFDQSxHQUFHQSxPQUFPQSxDQUFDQSxPQUFPQSxFQUFFQTtpQkFDeEJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBO2lCQUN2QkEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFFbkJBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ1ZBLENBQUNBO1FBUmVELE1BQUdBLE1BUWxCQSxDQUFBQTtRQUVEQSxJQUFJQSxVQUFVQSxHQUFHQTtZQUNoQkEsUUFBUUE7WUFDUkEsTUFBTUE7U0FDTkEsQ0FBQ0E7UUFFRkEsSUFBSUEsVUFBVUEsR0FBR0E7WUFDaEJBLE1BQU1BO1lBQ05BLFFBQVFBO1NBQ1JBLENBQUNBO1FBRUZBLElBQUlBLE1BQU1BLEdBQUdBLEVBRVpBLENBQUNBO1FBV0ZBO1lBUUNF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Q0EsT0FBT0EsQ0FBQ0EsVUFBQUEsQ0FBQ0E7b0JBQ2ZBLEVBQUVBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEtBQUlBLENBQUNBLEdBQUdBLEdBQUdBLFNBQVNBLEdBQUdBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBO2dCQUMvRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDSkEsQ0FBQ0E7WUFFU0wsNEJBQVVBLEdBQXBCQTtnQkFDQ00sRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7WUFDOUJBLENBQUNBO1lBRVNOLDRCQUFVQSxHQUFwQkE7Z0JBQ0NPLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7Z0JBQzNEQSxFQUFFQSxDQUFDQSxVQUFVQSxDQUFDQSxpQkFBaUJBLENBQUNBLFFBQVFBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBO2dCQUMzREEsRUFBRUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsR0FBR0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0E7WUFDbERBLENBQUNBO1lBQ0ZQLGNBQUNBO1FBQURBLENBaEZBRixBQWdGQ0UsSUFBQUY7SUFFRkEsQ0FBQ0EsRUFySFNELEVBQUVBLEdBQUZBLEtBQUVBLEtBQUZBLEtBQUVBLFFBcUhYQTtBQUFEQSxDQUFDQSxFQXJITSxFQUFFLEtBQUYsRUFBRSxRQXFIUiIsImZpbGUiOiJ1aS5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZSBoby51aSB7XG5cblx0ZXhwb3J0IGZ1bmN0aW9uIHJ1bihvcHRpb25zOklPcHRpb25zPW5ldyBPcHRpb25zKCkpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+IHtcblx0XHRvcHRpb25zID0gbmV3IE9wdGlvbnMob3B0aW9ucyk7XG5cblx0XHRsZXQgcCA9IG9wdGlvbnMucHJvY2VzcygpXG5cdFx0LnRoZW4oaG8uY29tcG9uZW50cy5ydW4pXG5cdFx0LnRoZW4oaG8uZmx1eC5ydW4pO1xuXG5cdFx0cmV0dXJuIHA7XG5cdH1cblxuXHRsZXQgY29tcG9uZW50cyA9IFtcblx0XHRcIlN0b3JlZFwiLFxuXHRcdFwiVmlld1wiLFxuXHRdO1xuXG5cdGxldCBhdHRyaWJ1dGVzID0gW1xuXHRcdFwiQmluZFwiLFxuXHRcdFwiQmluZEJpXCIsXG5cdF07XG5cblx0bGV0IHN0b3JlcyA9IFtcblxuXHRdO1xuXG5cdGV4cG9ydCBpbnRlcmZhY2UgSU9wdGlvbnMge1xuXHRcdHJvb3Q6IHN0cmluZyB8IHR5cGVvZiBoby5jb21wb25lbnRzLkNvbXBvbmVudDsgLy9Sb290IGNvbXBvbmVudCB0byByZWdpc3Rlcjtcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlcjsgLy9hbHRlcm5hdGl2ZSByb3V0ZXIgY2xhc3Ncblx0XHRtYXA6IHN0cmluZyB8IGJvb2xlYW47IC8vIGlmIHNldCwgbWFwIGFsbCBoby51aSBjb21wb25lbnRzIGluIHRoZSBjb21wb25lbnRwcm92aWRlciB0byB0aGUgZ2l2ZW4gdXJsXG5cdFx0ZGlyOiBib29sZWFuOyAvLyBzZXQgdXNlZGlyIGluIGhvLmNvbXBvbmVudHNcblx0XHRtaW46IGJvb2xlYW47XG5cdFx0cHJvY2VzczogKCk9PmhvLnByb21pc2UuUHJvbWlzZTxhbnksIGFueT47XG5cdH1cblxuXHRjbGFzcyBPcHRpb25zIGltcGxlbWVudHMgSU9wdGlvbnMge1xuXHRcdHJvb3Q6IHN0cmluZyB8IHR5cGVvZiBoby5jb21wb25lbnRzLkNvbXBvbmVudCA9IFwiQXBwXCJcblx0XHRyb3V0ZXI6IHN0cmluZyB8IHR5cGVvZiBoby5mbHV4LlJvdXRlciA9IGhvLmZsdXguUm91dGVyO1xuXHRcdG1hcDogc3RyaW5nIHwgYm9vbGVhbiA9IHRydWU7XG5cdFx0bWFwRGVmYXVsdCA9IFwiYm93ZXJfY29tcG9uZW50cy9oby11aS9kaXN0L1wiO1xuXHRcdGRpciA9IHRydWU7XG5cdFx0bWluID0gZmFsc2U7XG5cblx0XHRjb25zdHJ1Y3RvcihvcHQ6IElPcHRpb25zID0gPElPcHRpb25zPnt9KSB7XG5cdFx0XHRmb3IodmFyIGtleSBpbiBvcHQpIHtcblx0XHRcdFx0dGhpc1trZXldID0gb3B0W2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cHJvY2VzcygpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+e1xuXHRcdFx0cmV0dXJuIGhvLnByb21pc2UuUHJvbWlzZS5jcmVhdGUodGhpcy5wcm9jZXNzRGlyKCkpXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NNaW4uYmluZCh0aGlzKSlcblx0XHRcdC50aGVuKHRoaXMucHJvY2Vzc01hcC5iaW5kKHRoaXMpKVxuXHRcdFx0LnRoZW4odGhpcy5wcm9jZXNzUm91dGVyLmJpbmQodGhpcykpXG5cdFx0XHQudGhlbih0aGlzLnByb2Nlc3NSb290LmJpbmQodGhpcykpXG5cdFx0fVxuXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NSb290KCkge1xuXHRcdFx0cmV0dXJuIG5ldyBoby5wcm9taXNlLlByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHRpZih0eXBlb2YgdGhpcy5yb290ID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdGhvLmNvbXBvbmVudHMucmVnaXN0cnkuaW5zdGFuY2UubG9hZENvbXBvbmVudCg8c3RyaW5nPnRoaXMucm9vdClcblx0XHRcdFx0XHQudGhlbihyZXNvbHZlKVxuXHRcdFx0XHRcdC5jYXRjaChyZWplY3QpO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aG8uY29tcG9uZW50cy5yZWdpc3RyeS5pbnN0YW5jZS5yZWdpc3Rlcig8dHlwZW9mIGhvLmNvbXBvbmVudHMuQ29tcG9uZW50PnRoaXMucm9vdClcblx0XHRcdFx0XHRyZXNvbHZlKG51bGwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRwcm90ZWN0ZWQgcHJvY2Vzc1JvdXRlcigpOiBoby5wcm9taXNlLlByb21pc2U8YW55LCBhbnk+IHtcblx0XHRcdHJldHVybiBuZXcgaG8ucHJvbWlzZS5Qcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0aWYodHlwZW9mIHRoaXMucm91dGVyID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdGhvLmZsdXguU1RPUkVTLmxvYWRTdG9yZSg8c3RyaW5nPnRoaXMucm91dGVyKVxuXHRcdFx0XHRcdC50aGVuKHJlc29sdmUpXG5cdFx0XHRcdFx0LmNhdGNoKHJlamVjdCk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXNvbHZlKG5ldyAoPHR5cGVvZiBoby5mbHV4LlJvdXRlcj50aGlzLnJvdXRlcikoKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0fVxuXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NNYXAoKTogdm9pZCB7XG5cdFx0XHRpZih0eXBlb2YgdGhpcy5tYXAgPT09ICdib29sZWFuJykge1xuXHRcdFx0XHRpZighdGhpcy5tYXApXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0dGhpcy5tYXAgPSB0aGlzLm1hcERlZmF1bHQ7XG5cdFx0XHR9XG5cblx0XHRcdGNvbXBvbmVudHMuZm9yRWFjaChjID0+IHtcblx0XHRcdFx0aG8uY29tcG9uZW50cy5jb21wb25lbnRwcm92aWRlci5tYXBwaW5nW2NdID0gdGhpcy5tYXAgKyAnY29tcG9uZW50cy8nICsgYyArICcvJyArIGMgKyAnLmpzJztcblx0XHRcdH0pO1xuXG5cdFx0XHRhdHRyaWJ1dGVzLmZvckVhY2goYSA9PiB7XG5cdFx0XHRcdGhvLmNvbXBvbmVudHMuYXR0cmlidXRlcHJvdmlkZXIubWFwcGluZ1thXSA9IHRoaXMubWFwICsgJ2F0dHJpYnV0ZXMvJyArIGEgKyAnLycgKyBhICsgJy5qcyc7XG5cdFx0XHR9KTtcblxuXHRcdFx0c3RvcmVzLmZvckVhY2gocyA9PiB7XG5cdFx0XHRcdGhvLmZsdXguc3RvcmVwcm92aWRlci5tYXBwaW5nW3NdID0gdGhpcy5tYXAgKyAnc3RvcmVzLycgKyBzICsgJy8nICsgcyArICcuanMnO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cHJvdGVjdGVkIHByb2Nlc3NEaXIoKTogdm9pZCB7XG5cdFx0XHRoby5jb21wb25lbnRzLmRpciA9IHRoaXMuZGlyO1xuXHRcdH1cblxuXHRcdHByb3RlY3RlZCBwcm9jZXNzTWluKCk6IHZvaWQge1xuXHRcdFx0aG8uY29tcG9uZW50cy5jb21wb25lbnRwcm92aWRlci5pbnN0YW5jZS51c2VNaW4gPSB0aGlzLm1pbjtcblx0XHRcdGhvLmNvbXBvbmVudHMuYXR0cmlidXRlcHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XG5cdFx0XHRoby5mbHV4LnN0b3JlcHJvdmlkZXIuaW5zdGFuY2UudXNlTWluID0gdGhpcy5taW47XG5cdFx0fVxuXHR9XG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==